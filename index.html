<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Async i Await rozbrajanie pułapek przez Łotrzyka z .NET-em na poziomie 9.0 Preview 4</title>
        <meta charset="utf-8" />
        <meta http-equiv="x-ua-compatible" content="ie=edge" />
        <meta name="viewport" content="width=device-width" />
        <link href="https://fonts.googleapis.com/css?family=Fira+Sans:400,900&amp;subset=latin-ext" rel="stylesheet" />
        <!-- Shower Theme -->
        <link rel="stylesheet" href="vendors/shower-ribbon/styles/screen-16x9.css" />
        <link rel="stylesheet" href="vendors/shower-CezaryWalenciuk/styles/main.css" />
        <!-- Prism.js -->
        <!---<link rel="stylesheet" href="vendors/prism/prism-my-white.css" />
        <link rel="stylesheet" href="vendors/prism/custom-prism.css" />
        <link rel="stylesheet" href="codegrid-white.css" />
        -->
        <link rel="stylesheet" href="vendors/prism/prism-my-dark.css" />
        <link rel="stylesheet" href="vendors/prism/custom-prism.css" />
        <link rel="stylesheet" href="codegrid-dark.css" /> 
    
        <meta property="og:type" content="website">
        <meta property="og:title" content="Async i Await rozbrajanie pułapek przez Łotrzyka z .NET-em na poziomie 9.0 Preview 4">
        <meta property="og:description" content="Presentation for WDI">
        <meta property="og:url" content="https://github.com/PanNiebieski/MSTechSummit_Async_i_Await_rozbrajanie_pulapek_przez_Lotrzyka_z_NET-em_na_poziomie_9_0_Preview_3/">
        <meta property="og:site_name" content="Async i Await rozbrajanie pułapek przez Łotrzyka z .NET-em na poziomie 9.0 Preview 4">
        <meta property="og:image" content="https://github.com/PanNiebieski/MSTechSummit_Async_i_Await_rozbrajanie_pulapek_przez_Lotrzyka_z_NET-em_na_poziomie_9_0_Preview_3/forSocialMedia/FacebookImageForMainPage.jpg"><meta property="og:image:width" content="1200">
        <meta property="og:image:height" content="630">
        <meta name="twitter:title" content="Async i Await rozbrajanie pułapek przez Łotrzyka z .NET-em na poziomie 9.0 Preview 4">
        <meta name="twitter:description" content="Presentation for WDI">
        <meta name="twitter:image" content="https://github.com/PanNiebieski/MSTechSummit_Async_i_Await_rozbrajanie_pulapek_przez_Lotrzyka_z_NET-em_na_poziomie_9_0_Preview_3/forSocialMedia/FacebookImageForMainPage.jpg">
        <meta name="twitter:card" content="summary_large_image">
        <meta name="twitter:site" content="@walenciukc">
        <link rel="icon" type="image/png" sizes="16x16" href="https://github.com/PanNiebieski/MSTechSummit_Async_i_Await_rozbrajanie_pulapek_przez_Lotrzyka_z_NET-em_na_poziomie_9_0_Preview_3/forSocialMedia/icon/icon16x16.png">
        <link rel="apple-touch-icon" href="https://github.com/PanNiebieski/MSTechSummit_Async_i_Await_rozbrajanie_pulapek_przez_Lotrzyka_z_NET-em_na_poziomie_9_0_Preview_3/forSocialMedia/icon180x180.png">
        <link rel="shortcut icon" href="https://github.com/PanNiebieski/MSTechSummit_Async_i_Await_rozbrajanie_pulapek_przez_Lotrzyka_z_NET-em_na_poziomie_9_0_Preview_3/forSocialMedia/icon16x16.png">
        <meta name="msapplication-square150x150logo" content="https://github.com/PanNiebieski/MSTechSummit_Async_i_Await_rozbrajanie_pulapek_przez_Lotrzyka_z_NET-em_na_poziomie_9_0_Preview_3/forSocialMedia/icon180x180.png">
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    </head>
<body class="shower list">

    <header class="caption">
        <h1>Async i Await rozbrajanie pułapek przez Łotrzyka z .NET-em na poziomie 9.0 Preview 4</h1>
        <p></p>
    </header>
    <section class="slide front-page">
        <div class="details">
            <!-- 1. Avatar -->
            <span>Cezary Walenciuk</span>
            <!-- 3. Presentation title -->
            <h2 class="bigbig"><strong style="font-size: 35px;  line-height: 1.3;">

                    <span class="titlec1">Async i Await</span>
                    <br />
                    <span class="titlec5">rozbrajanie pułapek przez Łotrzyka<span>
                    <br />
                    <span class="titlec3">z .NET-em</span>
                    <br />
                    <span class="titlec1">na poziomie 9.0 Preview 4</span>
                </strong></h2>
            <!-- 5. Contact the speaker -->
            <h2><a href="https://twitter.com/WalenciukC">@walenciukC</a></h2>
        </div>
        <div>
            <!-- 2. Speaker -->
        </div>
        <div class="imag">
            <img src="images/my-avatar.jpg" alt="Speaker">
        </div>
    </section>
  
    <!--

Tylko najlepszy Łotrzyk zagląda do środka i widzi, że kompilator .NET zamienia nasze metody asynchroniczne w klasy? I że .NET dodaje blok try/catch do każdej z tych klas, potencjalnie ukrywając rzucone wyjątki? 

Podczas tej sesji dowiemy się, jak najlepiej wykorzystać async/await w języku C#, analizując sposób, w jaki .NET kompiluje nasz kod asynchroniczny.

Poza tym zobaczysz najnowsze bajery nawet ten jeden fajny z .NET 9 Preview


Co robi tak naprawdę async i await?
Co dodaje kompilator C#?
Ulepszymy kod async i await.
Najlepsze praktyki, czyli na jakie pułapki trzeba uważać.
Pokaż mi coś fajnego z .NET 9 Preview 3
-->

    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides2/1.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides2/2.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides2/3.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides2/4.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides2/5.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides2/6.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides2/7.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/02.gif" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/03.gif" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides/1.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides/2.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides/3.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides/4.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides/5.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides/6.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
  <!--
        Tutaj wstawić slajdy o procesorze
  -->
  <section class="slide" style="background-color:black">
    <figure>
        <img class="cover" src="pictures/slides/11.png" alt="blog">
        <figcaption class="white">CW</figcaption>
    </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG">
                <h2 class="headerCODE GG">Klasa Thread bez parametru</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 33px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 33px !important;">
                        static void Main(string[] args)
                        {
                            Thread thread = new Thread(new ThreadStart(Do));
                            thread.IsBackground = true;
                            thread.Start();
                            thread.Join();
                        }
                
                        public static void Do()
                        {}
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG">
                <h2 class="headerCODE GG">ThreadPool</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 37px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 37px !important;">
                        static void Main(string[] args)
                        {
                            ThreadPool.QueueUserWorkItem(Do);
                        }
                
                        public static void Do(object? state)
                        {}
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    Możesz dodać "zadanie"(workitem) do puli.
                </div>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG">
                <h2 class="headerCODE GG">IAsyncResult, czyli jak kiedyś robiło się asynchroniczne operacje</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 25px !important;">

                        static void Main(string[] args)
                        {              
                            Func&lt;int, int&gt; method =
                                (int a) =&gt; { return a; };
                
                            IAsyncResult handle =
                                method.BeginInvoke(100,
                                new AsyncCallback(WhenDone),
                                new object());
                        }
                
                        private static void WhenDone(IAsyncResult ar)
                        {
                            var target = (Func&lt;int, int&gt;)ar.AsyncState;
                            int result = target.EndInvoke(ar);
                
                            Console.WriteLine(result);
                        }
                    </code>
                </pre>
            </div>
          </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG">
                <h2 class="headerCODE GG">Event Asynchronous Pattern</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 20px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 20px !important;">
                        static void Main(string[] args)
                        {
                            var worker = new BackgroundWorker();
                
                            worker.DoWork += WorkerDoSomething;
                
                            worker.ProgressChanged += Worker_ProgressChanged;
                            worker.RunWorkerCompleted += Worker_RunWorkerCompleted;
                            worker.RunWorkerAsync(worker);
                        }
                
                        private static void Worker_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
                        {}
                        private static void WorkerDoSomething(object sender, DoWorkEventArgs e)
                        {}
                        private static void Worker_ProgressChanged(object sender, ProgressChangedEventArgs e)
                        {}
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
          </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides2/8.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides2/9.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/WPF APP.PNG" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG">
                <h2 class="headerCODE GG">Przykład zablokowania wątku UI w WPF</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 20px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 20px !important;">



                        private void Button_Click(object sender, RoutedEventArgs e)
                        {
                            Do();
                        }
                        
                        private void Do()
                        {
                            txtBlock.Text += &quot;Rozpoczynam liczenie&quot;;
                        
                            var result = HeavyCalculation(txt_X.Text, txt_Y.Text);
                        
                            txtBlock.Text += result;
                        }
                        
                        private string HeavyCalculation(string xT, string yT)
                        {
                            var x = int.Parse(xT);  
                            var y = int.Parse(yT);
                        
                            int addition = x + y; int subtraction = x - y;
                            int multiplication = x * y; double divison = x / y;
                        
                            Thread.Sleep(4000);
                        
                            return $&quot;\n{addition}, {subtraction}, {multiplication}, {divison}\n&quot;;
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG">
                <h2 class="headerCODE GG">Rozwiązanie tego problemu przy pomocy Task API z .NET Framework 4</h2>
            </div>
            <div class="PlaceCodeHere ">
                <pre style="font-size: 24px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 24px !important;">
                        private void Do()
                        {
                            txtBlock.Text += &quot;Rozpoczynam liczenie&quot;;
                        
                            var taskRun = Task.Run(() =&gt;HeavyCalculation(txt_X.Text, txt_Y.Text));
                        
                            taskRun.ContinueWith(ct =&gt;
                            {
                                    txtBlock.Text += ct.Result;
                            });
                        
                            taskRun.ContinueWith(ct =&gt;
                            {
                                if (ct.IsFaulted)
                                {
                                    txtBlock.Text += ct.Exception;
                                }
                            });
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG">
                <h2 class="headerCODE GG">Rozwiązanie tego problemu przy pomocy Task API z .NET Framework 4 PLUS synchronizacja wątku UI</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 24px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 24px !important;">


                        



                        private void Do()
                        {
                            txtBlock.Text += &quot;Rozpoczynam liczenie&quot;;
                            var x = txt_X.Text; var y = txt_Y.Text;
                            var taskRun = Task.Run(() =&gt;HeavyCalculation(x, y));
                        
                            taskRun.ContinueWith(ct =&gt;
                            {
                                Dispatcher.Invoke(() =&gt;
                                {
                                    txtBlock.Text += ct.Result;
                                });
                            });
                        
                            taskRun.ContinueWith(ct =&gt;
                            {
                                if (ct.IsFaulted)
                                {
                                    Dispatcher.Invoke(() =&gt;
                                    {
                                        txtBlock.Text += ct.Exception;
                                    });
                                }
                            });
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides2/27.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG">
                <h2 class="headerCODE GG">Task.Unwrap</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 34px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 34px !important;">
                        Task&#x3C;Task&#x3C;Task&#x3C;int&#x3E;&#x3E;&#x3E; t =
                            Task.Factory.StartNew
                            (() =>
                            {
                                return Task.Factory.StartNew(
                                () =>
                                Task.Run(() => { return 1; }));
            
                            });
            
                        var result = t.Result.Result.Result;
                    </code>
                </pre>
            </div>
          </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG">
                <h2 class="headerCODE GG">Task.Unwrap</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 34px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 34px !important;">
                        Task&#x3C;Task&#x3C;Task&#x3C;int&#x3E;&#x3E;&#x3E; t =
                            Task.Factory.StartNew
                            (() =>
                            {
                                return Task.Factory.StartNew(
                                () =>
                                Task.Run(() => { return 1; }));
            
                            });
                                    
                        var unwrap = t.Unwrap();
                        var unwrap2 = unwrap.Unwrap();
                        var result = unwrap2.Result;
                    </code>
                </pre>
            </div>
          </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides2/10.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG">
                <h2 class="headerCODE GG">WaitAll i WaitAny</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 44px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 44px !important;">
                        Task t1 = Task.Delay(2000);
                        Task t2 = Task.Delay(4000);
                        Task t3 = Task.Delay(6000);
            
                        Task.WaitAll(t1, t2, t3);
                        Task.WaitAny(t1, t2, t3);
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
          </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides2/11.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides2/12.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides2/13.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides2/14.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides2/15.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides2/16.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG">
                <h2 class="headerCODE GG">Async i Await z .NET Framework 4.5</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 24px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 24px !important;">






                        private async void Button_Click(object sender, RoutedEventArgs e)
                        {
                            await DoAsync();
                        }
                        
                        private async Task DoAsync()
                        {
                            txtBlock.Text += &quot;Rozpoczynam liczenie&quot;;
                        
                            var result = await HeavyCalculationAsync(txt_X.Text, txt_Y.Text);
                        
                            txtBlock.Text += result;
                        }
                        
                        private async Task&lt;string&gt; HeavyCalculationAsync(string xT, string yT)
                        {
                            var x = int.Parse(xT);
                            var y = int.Parse(yT);
                        
                            int addition = x + y; int subtraction = x - y;
                            int multiplication = x * y; double divison = x / y;
                        
                            await Task.Delay(4000);
                        
                            return $&quot;\n{addition}, {subtraction}, {multiplication}, {divison}\n&quot;;
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides/5.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides/7.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG">
                <h2 class="headerCODE GG">Async i Await obsługa wyjątku</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 24px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 24px !important;">
                        private async Task DoAsync()
                        {
                            txtBlock.Text += &quot;Rozpoczynam liczenie&quot;;
                            string result;
                        
                            try
                            {
                                result  = await HeavyCalculationAsync(txt_X.Text, txt_Y.Text);
                            }
                            catch (Exception ex)
                            {
                                result = ex.ToString();
                            }
                        
                            txtBlock.Text += result;
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides2/18.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides2/22.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides2/19.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides2/20.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides/9.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides/10.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides/12.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides/13.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides/14.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG ">
                <h2 class="headerCODE GG">Ile wątków ten kod stworzy?</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 16px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 16px !important;margin-left: -11em !important;">
                        static async Task Main()
                        {
                            WriteThread("Begin Main");
                            var a = await M1Async();
                            WriteThread("Middle Main");
                            var b = await M1Async();
                            Console.WriteLine(a + b);
                            WriteThread("End Main");
                            Console.ReadKey();
                        }
                
                        public static async Task&#x3C;int&#x3E; M1Async()
                        {
                            WriteThread("Begin M1Async");
                            var i = await M2Async();
                            WriteThread("End M1Async");
                            return i + 1;
                        }
                
                        public static async Task&#x3C;int&#x3E; M2Async()
                        {
                            WriteThread("At M2Async");
                            return -1;
                        }
                
                        public static void WriteThread(string helpfultoken)
                        {
                            Console.WriteLine(helpfultoken
                                + " : " + Thread.CurrentThread.ManagedThreadId);
                        }
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3>💡 Co pojawi się w konsoli?</h3>
                </div>
                <div class="odpowiedz full">
                    [Wszędzie będzie 1]
                </div>
            </div>
          </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG">
                <h2 class="headerCODE GG">Async i Await : Stan zadania decyduje czy nowy wątek zostanie stworzony</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 20px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 20px !important;">
                        static async Task Main()
                        {
                            WriteThread("Begin Main");
                            var a = await M1Async();
                            WriteThread("Middle Main");
                            var b = await M1Async();
                            Console.WriteLine(a + b);
                            WriteThread("End Main");
                            Console.ReadKey();
                        }
                
                        public static async Task&#x3C;int&#x3E; M1Async()
                        {
                            WriteThread("Begin M1Async");
                            await Task.Delay(2000);
                            WriteThread("End M1Async");
                            return 0;
                        }
                
                        public static void WriteThread(string helpfultoken)
                        {
                            Console.WriteLine(helpfultoken
                                + " : " + Thread.CurrentThread.ManagedThreadId);
                        }
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3>💡 Co pojawi się w konsoli?</h3>
                </div>
                <div class="odpowiedz full">
                    1,1,4,4,4,4
                </div>
            </div>
          </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG"> 
                <h2 class="headerCODE GG">Przykład prawdziwego kodu async i await</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 21px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 21px !important;">
                        var fact = await GetCatFactAsync(new HttpClient());
                        Console.WriteLine(fact.Fact);

                        async Task&lt;CatFact&gt; GetCatFactAsync(HttpClient client)
                        {
                            var response = await client.GetAsync(&quot;https://catfact.ninja/fact&quot;);
                            response.EnsureSuccessStatusCode();

                            var stream = await response.Content.ReadAsStreamAsync();

                            JsonSerializerOptions options = new();
                            options.PropertyNameCaseInsensitive = true;
                            var catfact = await JsonSerializer.DeserializeAsync&lt;CatFact&gt;(stream, options);

                            return catfact ?? throw new InvalidOperationException(&quot;CatFact can&#39;t be null&quot;);
                        }

                        public record CatFact(string? Fact, int Length);
                    </code>
                </pre>
            </div>
        </div>
    </section>
        <!-- TODO Wstawić kod ZE NIE TOWRZY NOWY WĄTEK-->  
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides/15.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG">
                <h2 class="headerCODE GG">Async i Await : maszyna stanów pamięta zakończenie</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 34px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 34px !important;">
                        Task&lt;string&gt; t = File.ReadAllTextAsync
                            (@&quot;D:\numbers.txt&quot;);

                        var numbers1 = await t;
                        var numbers2 = await t;
                        
                        Console.WriteLine
                        (object.ReferenceEquals(numbers1, numbers2));
                    </code>
                </pre>
            </div>
          </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides/16.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG">
                <h2 class="headerCODE GG">O co chodzi ?</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 17px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 17px !important;">
                        Console.WriteLine(DateTime.Now);

                        // This block takes 1 second to run because all
                        // 5 tasks are running simultaneously
                        {
                            var a = Task.Delay(1000);
                            var b = Task.Delay(1000);
                            var c = Task.Delay(1000);
                            var d = Task.Delay(1000);
                            var e = Task.Delay(1000);
                        
                            await a;
                            await b;
                            await c;
                            await d;
                            await e;
                        }
                        
                        Console.WriteLine(DateTime.Now);
                        
                        // This block takes 5 seconds to run because each "await"
                        // pauses the code until the task finishes
                        {
                            await Task.Delay(1000);
                            await Task.Delay(1000);
                            await Task.Delay(1000);
                            await Task.Delay(1000);
                            await Task.Delay(1000);
                        }
                        Console.WriteLine(DateTime.Now);
                    </code>
                </pre>
            </div>
          </div>
    </section>

    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides/17.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <!-- TODO Wstawić kod HIPOTEZY JAK DZIAŁĄ ASYNC I AWAIT--> 
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG">
                <h2 class="headerCODE GG">Hipoteza jak to działa</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 18px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 18px !important;">
                        static async Task Main()
                        {
                            Task&#x3C;int&#x3E; awaitableType = RandomNumberAsync();
                        
                            var awaiter = awaitableType.GetAwaiter();
                        
                            if (!awaiter.IsCompleted)
                            {
                                //robisz operacje kt&#xF3;ra nie jest zwi&#x105;zana
                                //z zako&#x144;czeniem tego zadania
                                //co&#x15B; mo&#x17C;e dzia&#x142;a&#x107; w tle
                                //To symulje kod przed wyra&#x17C;eniem await
                            }
                        
                            int a = awaiter.GetResult();
                            //kod po await
                        
                            //ten kod jest synchroniczny gdy&#x17C; nie jest on pakowany przez maszyn&#x119; stan&#xF3;w
                        }
                        
                        private static Task&#x3C;int&#x3E; RandomNumberAsync()
                        {
                            return Task.FromResult(4);
                        }
                    </code>
                </pre>
            </div>
          </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides/18.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG">
                <h2 class="headerCODE GG">Maszyna stanów async i await</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 22px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height:22px !important;">
                        static async Task BarAsync()
                        {
                            Console.WriteLine("This happens before await");
                        
                            int i = await QuxAsync();
                        
                            Console.WriteLine("This happens after await. The result of await is " + i);
                        }
                    </code>
                </pre>
            </div>
          </div>
    </section>
    
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides2/21.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG">
                <h2 class="headerCODE GG">Maszyna stanów async i await</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 22px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height:22px !important;">
                        private static Task BarAsync()
                        {
                          Program.&#x3C;BarAsync&#x3E;d__2 stateMachine;
                          stateMachine.&#x3C;&#x3E;t__builder = AsyncTaskMethodBuilder.Create();
                          stateMachine.&#x3C;&#x3E;1__state = -1;
                          stateMachine.&#x3C;&#x3E;t__builder.Start&#x3C;Program.&#x3C;BarAsync&#x3E;d__2&#x3E;(ref stateMachine);
                          return stateMachine.&#x3C;&#x3E;t__builder.Task;
                        }
                    </code>
                </pre>
            </div>
          </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG">
                <h2 class="headerCODE GG">Maszyna stanów async i await</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 10px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height:10px !important;">
                        private struct &#x3C;BarAsync&#x3E;d__2 : IAsyncStateMachine
                        {
                          public int &#x3C;&#x3E;1__state;
                          public AsyncTaskMethodBuilder &#x3C;&#x3E;t__builder;
                          private TaskAwaiter&#x3C;int&#x3E; &#x3C;&#x3E;u__1;
                        
                          void IAsyncStateMachine.MoveNext()
                          {
                            &#x9;int num1 = this.&#x3C;&#x3E;1__state;
                            &#x9;try
                            &#x9;{
                            &#x9;  TaskAwaiter&#x3C;int&#x3E; awaiter;
                            &#x9;  int num2;
                            &#x9;  if (num1 != 0)
                            &#x9;  {
                            &#x9;&#x9;Console.WriteLine(&#x22;This happens before await&#x22;);
                            &#x9;&#x9;awaiter = Program.QuxAsync().GetAwaiter();
                            &#x9;&#x9;if (!awaiter.IsCompleted)
                            &#x9;&#x9;{
                            &#x9;&#x9;  this.&#x3C;&#x3E;1__state = num2 = 0;
                            &#x9;&#x9;  this.&#x3C;&#x3E;u__1 = awaiter;
                            &#x9;&#x9;  this.&#x3C;&#x3E;t__builder.AwaitUnsafeOnCompleted&#x3C;TaskAwaiter&#x3C;int&#x3E;, Program.&#x3C;BarAsync&#x3E;d__2&#x3E;(ref awaiter, ref this);
                            &#x9;&#x9;  return;
                            &#x9;&#x9;}
                            &#x9;  }
                            &#x9;  else
                            &#x9;  {
                            &#x9;&#x9;awaiter = this.&#x3C;&#x3E;u__1;
                            &#x9;&#x9;this.&#x3C;&#x3E;u__1 = new TaskAwaiter&#x3C;int&#x3E;();
                            &#x9;&#x9;this.&#x3C;&#x3E;1__state = num2 = -1;
                            &#x9;  }
                            &#x9;  Console.WriteLine(&#x22;This happens after await. The result of await is &#x22; + (object) awaiter.GetResult());
                            &#x9;}
                            &#x9;catch (Exception ex)
                            &#x9;{
                            &#x9;  this.&#x3C;&#x3E;1__state = -2;
                            &#x9;  this.&#x3C;&#x3E;t__builder.SetException(ex);
                            &#x9;  return;
                            &#x9;}
                            &#x9;this.&#x3C;&#x3E;1__state = -2;
                            &#x9;this.&#x3C;&#x3E;t__builder.SetResult();
                          }
                        
                          [DebuggerHidden]
                          void IAsyncStateMachine.SetStateMachine(IAsyncStateMachine stateMachine)
                          {
                            &#x9;this.&#x3C;&#x3E;t__builder.SetStateMachine(stateMachine);
                          }
                        }
                    </code>
                </pre>
            </div>
          </div>
    </section>

    <section class="slide" style="background-color:whitesmoke">
        <figure>
            <img class="cover" src="pictures/06.png" alt="blog">
            <figcaption class="white">Copyright © Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:whitesmoke">
        <figure>
            <img class="cover" src="pictures/maszynastanow.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides/19.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>   
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG">
                <h2 class="headerCODE GG">Konstruktor w Task to red herring</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 37px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 37px !important;">

                        static async Task Main()
                        {
                            Task t = What();
                            await t;
                
                            var s = t.Status;
                        }
                
                        static Task What()
                        {
                            return new Task(
                                () => Console.WriteLine("1"));
                
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG">
                <h2 class="headerCODE GG">Poprawne użycie Task z async, aby wykonać długie zadanie które pierwotnie jest synchroniczne</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 34px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 34px !important;">
                        await Task.Run
                        (
                            () => DoExpensiveOperation(someParameter)
                        );
                    </code>
                </pre>
            </div>
          </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides/20.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>   
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG"> 
                <h2 class="headerCODE GG">Async Void w zdarzeniach w WPF</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 24px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 24px !important;">
                        private async void Button_Click(object sender, RoutedEventArgs e)
                        {
                            txtBlock.Text += &quot;Rozpoczynam liczenie&quot;;
                        
                            var result = await HeavyCalculationAsync(txt_X.Text, txt_Y.Text);
                        
                            txtBlock.Text += result;
                        }                              
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides/21.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>   
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG"> 
                <h2 class="headerCODE GG">Async Void w konstruktorze</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 24px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 24px !important;">
                        public class MyViewModel
                        {
                            public MyViewModel()
                            {
                                await RefreshData(CancellationToken.None);
                            }
                        
                            async Task RefreshData(CancellationToken ct)
                            {
                                await Task.Delay(100);
                            }
                        }                              
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/asyncvoid-01.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/asyncvoid-02.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>   
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/asyncvoid-03.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides/22.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>           
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG"> 
                <h2 class="headerCODE GG">Async Void i FireAndForgetSafeAsync</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 24px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 24px !important;">











                        public class MyViewModel
                        {
                            public MyViewModel()
                            {
                                RefreshData(CancellationToken.None)
                                    .FireAndForgetSafeAsync();
                        
                            }
                        
                            async Task RefreshData(CancellationToken ct)
                            {
                                await Task.Delay(100);
                            }
                        }
                        
                        public static class TaskUtilities
                        {                       
                            public static async void FireAndForgetSafeAsync(this Task task, 
                                Action&lt;Exception&gt; handler = null)
                            {
                                try
                                {
                                    await task;
                                }
                                catch (Exception ex)
                                {
                                    handler?.Invoke(ex);
                                }
                            }
                        }                      
                    </code>
                </pre>
            </div>
        </div>
    </section>  
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/asyncvoid-04.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG"> 
                <h2 class="headerCODE GG">Async Void</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 24px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 24px !important;">
                        public class MyViewModel
                        {
                            public MyViewModel()
                            {
                                RefreshData(CancellationToken.None)
                                    .SafeFireAndForget((e) =&gt; Console.WriteLine(e));
                        
                            }
                        
                            async Task RefreshData(CancellationToken ct)
                            {
                                await Task.Delay(100);
                            }
                        }
                                                   
                    </code>
                </pre>
            </div>
        </div>
    </section>  
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides/23.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>  
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides/24.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG"> 
                <h2 class="headerCODE GG">Nie wszystko trzeba awaitować</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 24px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 24px !important;">
                        private async Task StartAsync()
                        {
                            await InternalAsync1();
                        }
                        
                        private async Task InternalAsync1()
                        {
                            await InternalAsync2();
                        }
                        
                        private async Task InternalAsync2()
                        {
                            await InternalAsync3();
                        }
                        
                        private async Task InternalAsync3()
                        {
                            await Task.Delay(1000);
                        }                             
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG"> 
                <h2 class="headerCODE GG">Przykład techniki async eliding</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 24px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 24px !important;">
                        private async Task StartAsync()
                        {
                            await InternalAsync1();
                        }
                        
                        private async Task InternalAsync1()
                        {
                            return InternalAsync2();
                        }
                        
                        private Task InternalAsync2()
                        {
                            return InternalAsync3();
                        }
                        
                        private Task InternalAsync3()
                        {
                            return Task.Delay(1000);
                        }                             
                    </code>
                </pre>
            </div>
        </div>
    </section> 
    <!-- TODO Wstawić kod GDY ASYNC ELYDING NIE DZIAŁA result -->
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG">
                <h2 class="headerCODE GG">Eliding Async and Await : PROBLEM</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 30px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 30px !important;">
                        public async Task&#x3C;string&#x3E; GetWithKeywordsAsync(string url)
                        {
                            using (var client = new HttpClient())
                                return await client.GetStringAsync(url);
                        }
                            
                        public Task&#x3C;string&#x3E; GetElidingKeywordsAsync(string url)
                        {
                            using (var client = new HttpClient())
                                return client.GetStringAsync(url);
                        }
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                   
                </div>
            </div>
          </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides/25.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides/26.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides2/23.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides2/24.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section> 
    <!-- TODO Wstawić kod .Wait() result -->  
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides/27.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section> 
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides2/25.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>   
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG">
                <h2 class="headerCODE GG">.GetAwaiter().GetResult();</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 19px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 19px !important;">
                        
                        // Metoda synchronizująca wywołanie FetchDataAsync
                        public void FetchDataSynchronously()
                        {
                            try
                            {
                                // Wywołanie metody asynchronicznej w sposób synchroniczny
                                string result = FetchDataAsync().GetAwaiter().GetResult();
                                Console.WriteLine(result);
                            }
                            catch (Exception ex)
                            {
                                // Bezpośrednia obsługa wyjątków
                                Console.WriteLine($"Wystąpił błąd: {ex.Message}");
                            }
                        }

                        // Asynchroniczna metoda pobierająca dane
                        public async Task<string> FetchDataAsync()
                        {
                            using (HttpClient client = new HttpClient())
                            {
                                HttpResponseMessage response = 
                                    await client.GetAsync("https://jsonplaceholder.typicode.com/posts/1");
                                response.EnsureSuccessStatusCode();
                                return await response.Content.ReadAsStringAsync();
                            }
                        }
                    </code>
                </pre>
            </div>
          </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides/28.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <!-- TODO Wstawić kod deadlock sync over async -->      
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG">
                <h2 class="headerCODE GG">Deadlock</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 23px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 23px !important;">

                        private readonly static string _url = &#x22;https://postman-echo.com/delay/10&#x22;;

                        private void Button_Click(object sender, RoutedEventArgs e)
                        {
                            ResultTextBlock.Text = &#x22;&#x22;;
                            ResultTextBlock.Text += &#x22;Przed MyGetStringAsync()&#x22;;
                            var result = MyGetStringAsync().Result;
                            ResultTextBlock.Text += &#x22;Napisze co&#x15B; w mi&#x119;dzyczasie&#x22;;
                            ResultTextBlock.Text = result;
                            ResultTextBlock.Text += &#x22;Po MyGetStringAsync()&#x22;;
                        }
                        
                        public async Task&#x3C;string&#x3E; MyGetStringAsync()
                        {
                            using (HttpClient httpClient = new HttpClient())
                            {
                                return await httpClient.GetStringAsync(_url);
                            }
                        }
                    </code>
                </pre>
            </div>
          </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides2/26.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG">
                <h2 class="headerCODE GG">ConfigureAwait(false);</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 23px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 23px !important;">
                        
                        private readonly static string _url = &#x22;https://postman-echo.com/delay/10&#x22;;

                        private void Button_Click(object sender, RoutedEventArgs e)
                        {
                            ResultTextBlock.Text = &#x22;&#x22;;
                            ResultTextBlock.Text += &#x22;Przed MyGetStringAsync()&#x22;;
                            var result = MyGetStringAsync().Result;
                            ResultTextBlock.Text += &#x22;Napisze co&#x15B; w mi&#x119;dzyczasie&#x22;;
                            ResultTextBlock.Text = result;
                            ResultTextBlock.Text += &#x22;Po MyGetStringAsync()&#x22;;
                        }
                        
                        public async Task&#x3C;string&#x3E; MyGetStringAsync()
                        {
                            using (HttpClient httpClient = new HttpClient())
                            {
                                return await httpClient.GetStringAsync(_url)
                                    .ConfigureAwait(false);
                            }
                        }
                    </code>
                </pre>
            </div>
          </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides/32.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG"> 
                <h2 class="headerCODE GG">ConfigureAwait co właściwie robi</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 24px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 24px !important;">
                        private async Task DoAsync()
                        {
                            txtBlock.Text += &quot;Rozpoczynam liczenie&quot;;
                            string result;
                        
                            try
                            {
                                result = await HeavyCalculationAsync(txt_X.Text, txt_Y.Text)
                                    .ConfigureAwait(true);
                        
                               await SaveToFile(result).ConfigureAwait(false);
                            }
                            catch (Exception ex)
                            {
                                result = ex.ToString();
                            }
                        
                            txtBlock.Text += result;
                        }                          
                    </code>
                </pre>
            </div>
        </div>
    </section> 
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides/33.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <!-- <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides/32.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section> -->
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides/34.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG"> 
                <h2 class="headerCODE GG">ConfigureAwait w .NET 8</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 24px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 24px !important;">
                        private async Task DoAsync()
                        {
                            txtBlock.Text += &quot;Rozpoczynam liczenie&quot;;
                            string result;
                        
                            try
                            {
                                result = await HeavyCalculationAsync(txt_X.Text, txt_Y.Text)
                                    .ConfigureAwait(ConfigureAwaitOptions.ContinueOnCapturedContext);
                        
                               await SaveToFile(result).ConfigureAwait(ConfigureAwaitOptions.None
                                   | ConfigureAwaitOptions.SuppressThrowing
                                   | ConfigureAwaitOptions.ForceYielding);
                            }
                            catch (Exception ex)
                            {
                                result = ex.ToString();
                            }
                        
                            txtBlock.Text += result;
                        }                       
                    </code>
                </pre>
            </div>
        </div>
    </section> 
    <!-- <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/ConfigureAwait.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section> -->
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/ConfigureAwait-02.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/ConfigureAwait-03.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/ConfigureAwait-04.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides/35.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides/36.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides/29.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG"> 
                <h2 class="headerCODE GG">ThrowIfCancellationRequested</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 34px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 34px !important;">
                        private Task ForeverLong(CancellationToken ct)
                        {
                            while (true)
                            {
                                ct.ThrowIfCancellationRequested();
                        
                                //Cheking 
                        
                                Task.Delay(1000);
                            }
                        }                                         
                    </code>
                </pre>
            </div>
        </div>
    </section>          
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides/30.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG"> 
                <h2 class="headerCODE GG">WaitAsync</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 19px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 19px !important;">

                        public async Task DoWorkAsync()
                        {
                            // Symulacja długotrwałej operacji
                            await Task.Delay(5000);
                            Console.WriteLine("Operacja zakończona.");
                        }
                    
                        public async Task Run()
                        {
                            using var cts = new CancellationTokenSource();
                            Task mytask = DoWorkAsync();
                    
                            // Anuluj zadanie po 2 sekundach
                            cts.CancelAfter(2000);
                    
                            try
                            {
                                // Użycie WaitAsync, aby dodać możliwość anulowania
                                await mytask.WaitAsync(cts.Token);
                            }
                            catch (OperationCanceledException)
                            {
                                Console.WriteLine("Zadanie zostało anulowane.");
                            }
                        }                                      
                    </code>
                </pre>
            </div>
        </div>
    </section>          

    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides/31.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
       <!-- TODO Wstawić kod iASYNCENUMERALBE result -->
       <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG"> 
                <h2 class="headerCODE GG">Task IEnumerable przykład użycia</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 28px !important;">
                        private async Task&lt;IEnumerable&lt;string&gt;&gt; GeMyPoem()
                        {
                            using var stream = new StreamReader(@&quot;D:\p.txt&quot;);
                        
                            while (await stream.ReadLineAsync() is string line)
                            {
                                await Task.Delay(500);
                        
                                yield return line;
                            }
                        }                     
                    </code>
                </pre>
            </div>
        </div>
    </section>  
       <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG"> 
                <h2 class="headerCODE GG">IAsyncEnumerable przykład użycia</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 28px !important;">
                        private async IAsyncEnumerable&lt;string&gt; GeMyPoem()
                        {
                            using var stream = new StreamReader(@&quot;D:\p.txt&quot;);
                        
                            while (await stream.ReadLineAsync() is string line)
                            {
                                await Task.Delay(500);
                        
                                yield return line;
                            }
                        }                     
                    </code>
                </pre>
            </div>
        </div>
    </section>  
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG"> 
                <h2 class="headerCODE GG">IAsyncEnumerable przykład użycia</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 28px !important;">
                        private async IAsyncEnumerable&lt;string&gt; GeMyPoem()
                        {
                            using var stream = new StreamReader(@&quot;D:\p.txt&quot;);
                        
                            while (await stream.ReadLineAsync() is string line)
                            {
                                await Task.Delay(500);
                        
                                yield return line;
                            }
                        }                     
                    </code>
                </pre>
            </div>
        </div>
    </section>  
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG"> 
                <h2 class="headerCODE GG">IAsyncEnumerable przykład użycia</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 26px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 26px !important;">
                        private async void Button_Click(object sender, RoutedEventArgs e)
                        {
                            await Read();
                        }
                    
                        private async Task Read()
                        {
                            txtBlock.Text = "";
                            await foreach (var item in GeMyPoem())
                            {
                                txtBlock.Text += item + "\n";
                            }
                        }                
                    </code>
                </pre>
            </div>
        </div>
    </section>  

    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides/37.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <!-- TODO Wstawić kod VALUE TASK result -->
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG">
                <h2 class="headerCODE GG">new ValueTask</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 40px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 40px !important;">
                        public Task<int> GetCustomerIdAsync()
                        {
                            return Task.FromResult(1);
                        }

                        public ValueTask<int> GetCustomerIdAsync()
                        {
                            return new ValueTask(1);
                        }
                    </code>
                </pre>
            </div>
            <div class="AnswerCode">
                <div class="pytanie">
                    <h3></h3>
                </div>
                <div class="odpowiedz">
                    
                </div>
            </div>
          </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG">
                <h2 class="headerCODE GG">new ValueTask</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 20px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 20px !important;">
                        // WARNING
                        ValueTask&lt;int&gt; vt = SomeValueTaskReturningMethodAsync();
                        ... // storing the instance into a local makes it much more likely it&#39;ll be misused,
                            // but it could still be ok
                        
                        // BAD: awaits multiple times
                        ValueTask&lt;int&gt; vt = SomeValueTaskReturningMethodAsync();
                        int result = await vt;
                        int result2 = await vt;
                        
                        // BAD: awaits concurrently (and, by definition then, multiple times)
                        ValueTask&lt;int&gt; vt = SomeValueTaskReturningMethodAsync();
                        Task.Run(async () =&gt; await vt);
                        Task.Run(async () =&gt; await vt);
                        
                        // BAD: uses GetAwaiter().GetResult() when it&#39;s not known to be done
                        ValueTask&lt;int&gt; vt = SomeValueTaskReturningMethodAsync();
                        int result = vt.GetAwaiter().GetResult();
                    </code>
                </pre>
            </div>
          </div>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides2/17.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section> 
    <!-- TODO Wstawić kod CO JEST SZYBSZE PARREL -->  
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides/38.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/slides/39.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>

    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG"> 
                <h2 class="headerCODE GG">Problem przetwarzania tasków jak tylko się skończą</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 24px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 24px !important;">
                        List&lt;Task&lt;int&gt;&gt; tasks = Enumerable.Range(1,5).Select(Calculate).ToList();
                        
                        // Process tasks as they complete
                        while (downloadTasks.Any())
                        {
                            Task&lt;int&gt; finishedTask = await Task.WhenAny(tasks);
                            tasks.Remove(finishedTask);
                            int result = await finishedTask;
                            //ProcessDataChunk(result);
                            Console.WriteLine(result);
                        }                                       
                    </code>
                </pre>
            </div>
        </div>
    </section>     

    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG"> 
                <h2 class="headerCODE GG">Na pomoc przychodzi WhenEach</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 24px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 24px !important;">
                        namespace System.Threading.Tasks;

                        public class Task
                        {
                           public static IAsyncEnumerable&lt;Task&gt; WhenEach(params Task[] tasks);
                           public static IAsyncEnumerable&lt;Task&gt; WhenEach(params ReadOnlySpan&lt;Task&gt; tasks); // params when possible
                           public static IAsyncEnumerable&lt;Task&gt; WhenEach(IEnumerable&lt;Task&gt; tasks);
                        }                                    
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG"> 
                <h2 class="headerCODE GG">Na pomoc przychodzi WhenEach</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 24px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 24px !important;">
                        List&lt;Task&lt;int&gt;&gt; tasks = Enumerable.Range(1,5).Select(Calculate).ToList();

                        await foreach (var item in Task.WhenEach(tasks))
                        {
                            Console.WriteLine(item);
                        }
                        
                        async Task&lt;int&gt; Calculate(int order)
                        {
                            var number = Random.Shared.Next(500, 5000);
                        
                            await Task.Delay(number);
                        
                            return number;
                        }                           
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle GG"> 
                <h2 class="headerCODE GG">Na pomoc przychodzi WhenEach</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 24px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 24px !important;">
                        using var cts = new CancellationTokenSource(10_000);
                        await foreach (var item in Task.WhenEach(connectionRequests).WithCancellation(cts.Token))
                        {
                            // If TryReset fails, the timeout expired right after the last task completed.
                            if (!cts.TryReset()) cts.Token.ThrowIfCancellationRequested();
                        
                            ProcessItem(item.Result);
                        
                            cts.CancelAfter(10_000); // Start the timer again
                        }                         
                    </code>
                </pre>
            </div>
        </div>
    </section>        
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/MSTS24-204-OADN-11.png" alt="blog">
            <figcaption class="white">CW</figcaption>
        </figure>
    </section>
    <!-- <div class="progress"></div> -->
    <footer class="badge badge-top-left">
        <a href="#" class="fullscreen">Fullscreen</a>
    </footer>

    <script src="vendors/gamepad/gamepad.js"></script>
    <script src="vendors/shower/shower.min.js"></script>
    <script src="vendors/shower-gamepad/shower.gamepad.js"></script>

    <!-- Prism.js -->
    <script src="vendors/prism/prism.js"></script>
    <script src="vendors/prism/custom-prism.js"></script>

</body>

</html>